
# Курс 9. Итоговое задание
## ## Тема итоговой работы "Автодеплой на сервер:
___

---

Текущая архитектура проекта:

1. **GitHub Actions workflow**:
    
    - Запускается при push/pull request в ветку `feature2`
        
    - Выполняет линтинг (flake8)
        
    - Запускает тесты
        
    - Собирает статические файлы
        
    - Собирает Docker образ и пушит его в Docker Hub
        
    - Деплоит на сервер через SSH
        
2. **Docker инфраструктура**:
    
    - Основной сервис `web` (Django + Gunicorn)
        
    - PostgreSQL
        
    - Redis
        
    - Celery (worker + beat)
        
    - Nginx
___
## manual & control

### Ручной деплой
- На сервере установите Docker, docker-compose, git.
- Клонируете репозиторий на сервер и заполните .env файл с помощью шаблона .env.sample
- В терминале сервера запустите команду: `sudo docker-compose up -d --build`
- Приложение будет доступно по ip-адресу вашего сервера
___
### Автоматический деплой с помощью CI/CD
- Клонируете репозиторий и заполните .env файл с помощью шаблона .env.sample и затем разместите проект на своём репозитории
- Создайте секреты используемые в проекте:

###### DOCKER_HUB_ACCESS_TOKEN



###### DOCKER_HUB_USERNAME



###### SSH_PRIVATE_KEY


###### SSH_USER


###### SERVER_IP



- сделайте commit & push
- приложение будет доступно по IP-адресу вашего сервера
___
### Установка через **Docker**:

- Клонируете репозиторий и заполните .env файл с помощью шаблон .env.example и затем в консоле введите команду `docker-compose up -d --build`
___
### Без **Docker**:


- Для запуска установите зависимости из файла requirements.txt

         
# О проекте :
___
1. Создан новый Django-проект, подключен DRF в настройках проекта.
2. Созданы следующие модели:
Пользователь: все поля от обычного пользователя, но авторизацию заменить на email; телефон; город; аватарка. <br> Модель пользователя разместите в приложении users

•Курс:
название, превью (картинка), описание.

•Урок:
название, описание, превью (картинка), ссылка на видео.

3. Описан CRUD для моделей курса и урока. Для реализации CRUD для курса использован Viewsets, а для урока - Generic-классы.
4. Для модели курса добавлен в сериализатор поле вывода количества уроков.
5. Описана новая модель для платежей в приложении "users"
6. Добавлена фильтрация для списка платежей
7. Реализован CRUD для пользователей, регистрация и JWT-авторизация.
8. Создана группа модераторов с правами только на просмотр и изменение. Добавлен функционал проверки в контроллеры.
9. Описаны права доступа для объектов. Если пользователь не входит в группу модераторов может видеть, редактировать и удалять только свои уроки и курсы.
10. Реализованна дополнительная валидация ссылки на видео (разрешен толь доступ к youtube.com)
11. Добавлена модель подписки на обновления курса для пользователя.
12. Реализована пагинация для вывода всех уроков и курсов.
13. Описаны тесты, которые будут проверять корректность работы CRUD уроков и функционал работы подписки на обновления курса.
14. Подключена и произведена настройка вывода документации drf-yasg
15. Подключена возможность оплаты курсов через сервис stripe
16. Проект настроен для работы с Celery и Celery-beat
17. Добавлена асинхронная задача рассылки писем об обновлении курса на который они подписаны
18. Реализована фоновая задача которая деактивирует пользователя если он не неактивен в течении 30 дней
